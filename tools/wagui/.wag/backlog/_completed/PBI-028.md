# PBI-028: Transcript Message Filtering

## User Story

As a wagui user, I want system infrastructure messages filtered from the chat display so that I only see actual conversation messages.

## Problem

The transcript polling feature shows messages that are not actual user/assistant chat:

1. **Command invocation tags** - `<command-message>wagu</command-message>` etc. - skill/slash command metadata injected into transcripts
2. **Context compaction summaries** - "This session is being continued from a previous conversation..." - large infrastructure messages when context resets
3. **System reminder tags** - `<system-reminder>` blocks embedded in messages

These clutter the chat UI and confuse users about what was actually said.

## Solution

Add filtering logic to `parseTranscriptEntry` in `server/transcript.ts` to skip or clean these messages:

```typescript
// Skip command invocation messages
if (text.startsWith('<command-message>'))
    return null

// Skip context compaction summaries
if (text.includes('This session is being continued from a previous conversation'))
    return null

// Strip system-reminder tags from content
text = text.replace(/<system-reminder>[\s\S]*?<\/system-reminder>/g, '')
```

## Acceptance Criteria

- [ ] Command invocation messages (`<command-message>`) filtered out
- [ ] Context compaction summaries filtered out
- [ ] System reminder tags stripped from message content
- [ ] Only actual user/assistant conversation appears in wagui chat
- [ ] Tests added for filtering logic

## Technical Notes

- Filtering happens in `parseTranscriptEntry` before message is saved
- May need regex patterns for edge cases
- Consider making filters configurable in future

## Priority

P1 - Affects usability of transcript polling feature

## Dependencies

- PBI-029 (Transcript Polling) - completed

## Estimate

Small - filtering logic in one function
